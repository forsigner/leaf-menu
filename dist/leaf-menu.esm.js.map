{"version":3,"file":"leaf-menu.esm.js","sources":["../src/GlobalStore.tsx","../src/lib/utils.ts","../src/ApiList.tsx","../src/Tree/TreeNode.tsx","../src/lib/tree.ts","../src/Tree/Tree.tsx","../src/index.tsx"],"sourcesContent":["import React from 'react';\n\nconst GlobalStore = React.createContext({});\n\nexport default GlobalStore;\n","export const utils = {\n  addClass,\n  removeClass,\n};\n\nexport default utils;\n\nfunction addClass(element: any, className: string) {\n  if (!element) return;\n  const classes = element.className.split(' ');\n  if (classes.indexOf(className) < 0) {\n    classes.push(className);\n  }\n\n  element.className = classes.join(' ');\n  return element;\n}\n\nfunction removeClass(element: any, className: string) {\n  if (!element) return;\n  const classes = element.className.split(' ');\n  const index = classes.indexOf(className);\n  if (index > -1) {\n    classes.splice(index, 1);\n  }\n\n  element.className = classes.join(' ');\n  return element;\n}","import React from 'react';\nimport { Input } from 'antd';\nimport styled from 'styled-components';\n\nimport GlobalStore from './GlobalStore';\nimport utils from './lib/utils';\n\nconst Wrapper = styled.div``;\n\nconst Search = styled(Input.Search)`\n  margin-bottom: 10px;\n  &.ant-input-affix-wrapper {\n    padding: 2px 10px;\n    .ant-input-suffix {\n      right: 20px !important;\n    }\n  }\n  .ant-input {\n    border-radius: 20px;\n    border: 0;\n    background: #f5f5f5;\n    &:focus {\n      background: #f0f0f0;\n      box-shadow: none;\n    }\n  }\n`;\n\nconst Title = styled.div`\n  padding: 8px 16px;\n  font-size: 14px;\n  > i {\n    padding-right: 6px;\n  }\n`;\n\nconst List = styled.ul``;\n\nconst Item = styled.li`\n  padding: 8px 16px;\n  color: #999;\n  &.active,\n  &:hover {\n    color: #333;\n    background: #f8f8f8;\n    cursor: pointer;\n  }\n`;\n\nconst Method = styled.span`\n  overflow: hidden;\n  display: inline-block;\n  width: 40px;\n  font-size: 10px;\n  font-weight: lighter;\n  text-transform: lowercase;\n  &.GET {\n    color: #1abc9c;\n  }\n  &.POST {\n    color: #f39c12;\n  }\n  &.PUT {\n    color: #9b59b6;\n  }\n  &.DELETE {\n    color: #e74c3c;\n  }\n  &.PATCH {\n    color: #3498db;\n  }\n  &.OPTION {\n    color: #2ecc71;\n  }\n`;\n\nconst Url = styled.span`\n  display: inline-block;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  font-size: 12px;\n  font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier,\n    monospace;\n  width: 188px;\n`;\n\nclass ApiList extends React.Component {\n  state = {\n    q: '',\n  };\n\n  highlightItem = (event: any) => {\n    const $nodes = document.querySelectorAll('.leaf-list-node');\n    const nodeArray = Array.prototype.slice.call($nodes);\n    // 移除全部高亮\n    nodeArray.forEach(dom => {\n      utils.removeClass(dom, 'active');\n    });\n\n    // 高亮当前dom\n    utils.addClass(event.currentTarget, 'active');\n  };\n\n  onSelect = ({ node, event, onSelect }: any) => {\n    this.highlightItem(event);\n    onSelect(node);\n  };\n\n  onKeyUp = e => {\n    this.setState({ q: e.target.value });\n  };\n\n  renderBody = context => {\n    const { apis, name, onSelect } = context;\n    const filteredApis = apis.filter(item => {\n      const { q } = this.state;\n      if (q === '') return true;\n      return item.path.indexOf(q) > -1;\n    });\n\n    return (\n      <Wrapper>\n        <Title>\n          {/* <Icon type=\"api\" /> */}\n          {name}\n        </Title>\n        <Search placeholder=\"搜索接口\" onKeyUp={this.onKeyUp} />\n        <List>\n          {filteredApis.map(api => (\n            <Item\n              key={api.slug}\n              id={api.slug}\n              onClick={event => this.onSelect({ node: api, event, onSelect })}\n              className=\"leaf-list-node\"\n            >\n              <Method className={api.method}>{api.method}</Method>\n              <Url>{api.path}</Url>\n            </Item>\n          ))}\n        </List>\n      </Wrapper>\n    );\n  };\n\n  render() {\n    return (\n      <GlobalStore.Consumer>\n        {context => this.renderBody(context)}\n      </GlobalStore.Consumer>\n    );\n  }\n}\n\nexport default ApiList;\n","/**\n * @description Tree\n */\nimport React from 'react';\nimport { Icon } from 'antd';\nimport styled from 'styled-components';\nimport { ContextMenuTrigger } from 'react-contextmenu';\n\nimport utils from '../lib/utils';\n\nconst Item = styled.li`\n  padding: 4px 0 4px 15px;\n`;\n\nconst Title = styled.div`\n  cursor: pointer;\n  &:hover {\n    color: #1abc9c;\n  }\n  &.active {\n    color: #1abc9c;\n    border-right: 2px solid #000;\n  }\n`;\n\nconst Method = styled.span`\n  font-size: 9px;\n  color: #ccc;\n  font-weight: light;\n`;\n\nconst Name = styled.span`\n  font-size: 14px;\n`;\n\nconst Leaf = styled.ul``;\n\nconst IconToggle = styled(Icon)`\n  font-size: 10px;\n  margin-right: 8px;\n`;\n\nconst IconFile = styled(Icon)`\n  font-size: 12px;\n  margin-right: 8px;\n`;\n\nclass TreeNode extends React.Component<any, any> {\n  constructor(props) {\n    super(props);\n    this.state = {\n      visible: false,\n    };\n  }\n\n  highlightItem = (node, event) => {\n    const $titleNodes = document.querySelectorAll('.leaf-tree-node');\n    const nodeArray = Array.prototype.slice.call($titleNodes);\n\n    if (node.type === 'file') {\n      // 移除全部高亮\n      nodeArray.forEach(dom => {\n        utils.removeClass(dom, 'active');\n      });\n\n      // 高亮当前dom\n      utils.addClass(event.currentTarget, 'active');\n    }\n  };\n\n  toggle = (node, event) => {\n    this.props.onSelect(node);\n    const { isRoot } = node;\n    if (isRoot) {\n      this.setState({ visible: this.state.visible });\n    } else {\n      this.setState({ visible: !this.state.visible });\n    }\n    this.highlightItem(node, event);\n  };\n\n  render() {\n    let treeNodes;\n    const { node, onSelect = {} } = this.props;\n    const { slug, type, title, method = '', url, isRoot } = node;\n    const tips = type === 'file' ? `${method}: ${url}` : '';\n    const { visible } = this.state;\n    const style = { display: visible || isRoot ? 'block' : 'none' };\n\n    if (node.children != null) {\n      treeNodes = node.children.map(node => (\n        <TreeNode key={node.key} onSelect={onSelect} node={node} />\n      ));\n    }\n\n    return (\n      <Item title={tips}>\n        <ContextMenuTrigger id=\"leaf-api-menu\" collect={() => collect(node)}>\n          <Title\n            id={slug}\n            className=\"leaf-tree-node\"\n            onClick={event => this.toggle(node, event)}\n          >\n            {renderToggle(type, this.state.visible)}\n            {renderIcon(type)}\n            <Name>{title}</Name>\n            {method && <Method>.{method.toLowerCase()}</Method>}\n          </Title>\n        </ContextMenuTrigger>\n        <Leaf style={style}>{treeNodes}</Leaf>\n      </Item>\n    );\n  }\n}\n\nexport default TreeNode;\n\n// ////////////////////////////////\n\nfunction renderIcon(type) {\n  return type === 'file' ? (\n    <IconFile type=\"file-text\" />\n  ) : (\n    <IconFile type=\"folder\" />\n  );\n}\n\nfunction renderToggle(type, visible) {\n  if (type === 'file') return null;\n  return visible ? <IconToggle type=\"down\" /> : <IconToggle type=\"right\" />;\n}\n\nfunction collect(node) {\n  return { node };\n}\n","import _ from 'lodash';\n\nconst DEFAULT_ACTIVITY_NAME = '__apis__';\nconst NODE_TYPE = {\n  DIRECTORY: 'directory',\n  FILE: 'file',\n};\n\nexport default function tree(apis: any, projectName: string) {\n  if (!apis || apis.length === 0) {\n    return {};\n  }\n  apis = setUrlArr(apis, projectName);\n  let items: any = setParentId(apis);\n  items = uniq(items);\n\n  const d = _.filter(items, (i: any) => i.type === 'directory');\n  const f = _.filter(items, (i: any) => i.type === 'file');\n  const nodes = d.concat(sort(f));\n  items = nodeToTree(nodes);\n\n  return items;\n}\n\nfunction nodeToTree(nodes: any) {\n  const idToNodeMap = {};\n  let roots = null;\n\n  if (!nodes || !nodes.length) {\n    return [];\n  }\n\n  nodes.forEach((item: any) => {\n    const filters = nodes.filter((i: any) => {\n      return item.id === i.parentId;\n    });\n\n    if (filters.length > 0 || typeof item.parentId === 'undefined') {\n      item.children = [];\n    }\n\n    idToNodeMap[item.id] = item;\n\n    if (typeof item.parentId === 'undefined') {\n      roots = item;\n    } else {\n      const parentNode = idToNodeMap[item.parentId];\n      if (parentNode.children) {\n        parentNode.children.push(item);\n      }\n    }\n  });\n  return roots;\n}\n\nfunction setUrlArr(apis: any, projectName: string) {\n  const rootNode = projectName ? `${projectName}'s API` : DEFAULT_ACTIVITY_NAME;\n  return _.map(apis, item => {\n    const urlArr = item.path.split('/');\n    urlArr[0] = rootNode;\n    return { ...item, urlArr };\n  });\n}\n\nfunction setParentId(apis: any) {\n  const items: any = [];\n  _.forEach(apis, i => {\n    const l = i.urlArr.length;\n    const urlArr = i.urlArr;\n    let output;\n    _.forEach(urlArr, (value, index: any) => {\n      const isRoot = index === 0;\n      const isDirectory = index < l - 1;\n\n      if (isRoot) {\n        output = {\n          id: `/${value}/`,\n          isRoot: true,\n          key: `/${value}/`,\n          name: value,\n          title: value,\n          // parentId: ROOT_NODE_PARENT_ID,\n          type: NODE_TYPE.DIRECTORY,\n        };\n\n        // 文件夹\n      } else if (isDirectory) {\n        output = {\n          title: value,\n          name: urlArr[index],\n          id: `/${urlArr.slice(0, index + 1).join('/')}/`,\n          key: `/${urlArr.slice(0, index + 1).join('/')}/`,\n          parentId: `/${urlArr.slice(0, index).join('/')}/`,\n          type: NODE_TYPE.DIRECTORY,\n        };\n\n        // 文件\n      } else {\n        output = {\n          title: value,\n          name: `${_.last(urlArr)}.${i.type}.md`,\n          id: `/${urlArr.slice(0, index + 1).join('/')}${i.method}/`,\n          key: `/${urlArr.slice(0, index + 1).join('/')}${i.method}/`,\n          _id: i._id,\n          parentId: `/${i.urlArr.slice(0, index).join('/')}/`,\n          type: NODE_TYPE.FILE,\n          path: i.path,\n          url: i.url,\n          apiId: i._id,\n          method: i.method,\n          slug: i.slug,\n        };\n      }\n      items.push(output);\n    });\n  });\n  return items;\n}\n\nfunction uniq(items: any) {\n  const result = items.map((i: any) => JSON.stringify(i));\n  return _.uniq(result).map((i: string) => JSON.parse(i));\n}\n\nfunction sort(nodes: any) {\n  const sortedNodes = nodes.slice(1).sort((a: any, b: any) => {\n    if (a.name.charCodeAt(0) > b.name.charCodeAt(0)) {\n      return 1;\n    }\n    if (a.name.charCodeAt(0) < b.name.charCodeAt(0)) {\n      return -1;\n    }\n    return 0;\n  });\n  return [nodes[0], ...sortedNodes];\n}\n","/**\n * @description Tree Node\n */\nimport React from 'react';\n\nimport { ContextMenu, MenuItem } from 'react-contextmenu';\nimport styled from 'styled-components';\n\nimport GlobalStore from '../GlobalStore';\nimport TreeNode from './TreeNode';\nimport tree from '../lib/tree';\n\nconst Wrapper = styled.div`\n  .leaf-api-menu {\n    cursor: pointer;\n    background: #fff;\n    border-radius: 4px;\n    box-shadow: 0 1px 6px rgba(0, 0, 0, 0.2);\n    .react-contextmenu-item {\n      padding: 10px 20px;\n    }\n  }\n`;\n\nclass Tree extends React.Component {\n  create = ({ data, context }) => {\n    if (context.onCreate) {\n      context.onCreate(data.node);\n    }\n  };\n\n  delete = ({ data, context }) => {\n    if (context.onDelete) {\n      context.onDelete(data.node);\n    }\n  };\n\n  renderBody = context => {\n    const { apis, name, onSelect } = context;\n    const data = tree(apis, name) || {};\n    return (\n      <Wrapper>\n        <ContextMenu className=\"leaf-api-menu\" id=\"leaf-api-menu\">\n          <MenuItem\n            data={{ action: 'create' }}\n            onClick={data => this.create({ data, context })}\n          >\n            新建接口\n          </MenuItem>\n          <MenuItem\n            data={{ action: 'delete' }}\n            onClick={data => this.delete({ data, context })}\n          >\n            删除\n          </MenuItem>\n          {/* <MenuItem data={{ action: 'update' }} onClick={this.handleClick}>\n            修改\n          </MenuItem> */}\n        </ContextMenu>\n        <ul>\n          <TreeNode onSelect={onSelect as any} node={data} />\n        </ul>\n      </Wrapper>\n    );\n  };\n\n  render() {\n    return (\n      <GlobalStore.Consumer>\n        {context => this.renderBody(context)}\n      </GlobalStore.Consumer>\n    );\n  }\n}\n\nexport default Tree;\n","import { Tabs } from 'antd';\nimport React, { Component } from 'react';\nimport styled from 'styled-components';\n\nimport List from './ApiList';\nimport GlobalStore from './GlobalStore';\nimport Tree from './Tree/Tree';\n\nconst TabPane = Tabs.TabPane;\n\nconst Wrapper = styled.div`\n  .ant-tabs-bar {\n    margin-bottom: 2px !important;\n  }\n  .ant-tabs-nav .ant-tabs-tab {\n    padding: 12px 10px;\n  }\n`;\n\ninterface Props {\n  apis?: any;\n  name?: 'DEFAULT_NAME' | string;\n  onSelect?: () => void;\n  onCreate?: () => void;\n  onDelete?: () => void;\n  onUpdate?: () => void;\n  tabBarExtraContent?: null;\n}\n\nclass LeafMenu extends Component<Props> {\n  public static defaultProps = {\n    apis: [],\n    name: 'demo1',\n    onCreate: null,\n    onDelete: null,\n    onSelect: null,\n    onUpdate: null,\n    tabBarExtraContent: null,\n  };\n\n  public render() {\n    const { name, tabBarExtraContent } = this.props;\n\n    if (!name) {\n      return null;\n    }\n    return (\n      <GlobalStore.Provider value={{ ...this.props }}>\n        <Wrapper>\n          <Tabs tabBarExtraContent={tabBarExtraContent}>\n            <TabPane tab=\"树形\" key=\"1\">\n              <Tree />\n            </TabPane>\n            <TabPane tab=\"列表\" key=\"2\">\n              <List />\n            </TabPane>\n          </Tabs>\n        </Wrapper>\n      </GlobalStore.Provider>\n    );\n  }\n}\n\nexport default LeafMenu;\n"],"names":["GlobalStore","React","createContext","utils","addClass","removeClass","element","className","classes","split","indexOf","push","join","index","splice","Wrapper","styled","div","Search","Input","Title","List","ul","Item","li","Method","span","Url","ApiList","q","event","$nodes","document","querySelectorAll","nodeArray","Array","prototype","slice","call","forEach","dom","currentTarget","node","onSelect","highlightItem","e","setState","target","value","context","apis","name","filteredApis","filter","item","state","path","placeholder","onKeyUp","map","api","key","slug","id","onClick","method","render","Consumer","renderBody","Component","Name","Leaf","IconToggle","Icon","IconFile","TreeNode","props","$titleNodes","type","isRoot","visible","treeNodes","title","url","tips","style","display","children","ContextMenuTrigger","collect","toggle","renderToggle","renderIcon","toLowerCase","DEFAULT_ACTIVITY_NAME","NODE_TYPE","DIRECTORY","FILE","tree","projectName","length","setUrlArr","items","setParentId","uniq","d","_","i","f","nodes","concat","sort","nodeToTree","idToNodeMap","roots","filters","parentId","parentNode","rootNode","urlArr","l","output","isDirectory","last","_id","apiId","result","JSON","stringify","parse","sortedNodes","a","b","charCodeAt","Tree","data","onCreate","onDelete","ContextMenu","MenuItem","action","create","TabPane","Tabs","LeafMenu","tabBarExtraContent","Provider","tab","onUpdate"],"mappings":"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"}