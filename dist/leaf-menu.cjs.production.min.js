"use strict";function n(n){return n&&"object"==typeof n&&"default"in n?n.default:n}Object.defineProperty(exports,"__esModule",{value:!0});var e=require("antd"),t=require("react"),r=n(t),o=n(require("styled-components")),i=require("react-contextmenu"),a=n(require("lodash"));function c(){return(c=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n}).apply(this,arguments)}function u(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.__proto__=e}function l(n,e){return e||(e=n.slice(0)),n.raw=e,n}var f=r.createContext({}),p=function(n,e){if(n){var t=n.className.split(" ");return t.indexOf(e)<0&&t.push(e),n.className=t.join(" "),n}},s=function(n,e){if(n){var t=n.className.split(" "),r=t.indexOf(e);return r>-1&&t.splice(r,1),n.className=t.join(" "),n}};function d(){var n=l(["\n  display: inline-block;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  font-size: 12px;\n  font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier,\n    monospace;\n  width: 188px;\n"]);return d=function(){return n},n}function m(){var n=l(["\n  overflow: hidden;\n  display: inline-block;\n  width: 40px;\n  font-size: 10px;\n  font-weight: lighter;\n  text-transform: lowercase;\n  &.GET {\n    color: #1abc9c;\n  }\n  &.POST {\n    color: #f39c12;\n  }\n  &.PUT {\n    color: #9b59b6;\n  }\n  &.DELETE {\n    color: #e74c3c;\n  }\n  &.PATCH {\n    color: #3498db;\n  }\n  &.OPTION {\n    color: #2ecc71;\n  }\n"]);return m=function(){return n},n}function v(){var n=l(["\n  padding: 8px 16px;\n  color: #999;\n  &.active,\n  &:hover {\n    color: #333;\n    background: #f8f8f8;\n    cursor: pointer;\n  }\n"]);return v=function(){return n},n}function h(){var n=l([""]);return h=function(){return n},n}function y(){var n=l(["\n  padding: 8px 16px;\n  font-size: 14px;\n  > i {\n    padding-right: 6px;\n  }\n"]);return y=function(){return n},n}function x(){var n=l(["\n  margin-bottom: 10px;\n  &.ant-input-affix-wrapper {\n    padding: 2px 10px;\n    .ant-input-suffix {\n      right: 20px !important;\n    }\n  }\n  .ant-input {\n    border-radius: 20px;\n    border: 0;\n    background: #f5f5f5;\n    &:focus {\n      background: #f0f0f0;\n      box-shadow: none;\n    }\n  }\n"]);return x=function(){return n},n}function g(){var n=l([""]);return g=function(){return n},n}var b=o.div(g()),E=o(e.Input.Search)(x()),C=o.div(y()),S=o.ul(h()),k=o.li(v()),I=o.span(m()),w=o.span(d()),A=function(n){function e(){var e;return(e=n.apply(this,arguments)||this).state={q:""},e.highlightItem=function(n){var e=document.querySelectorAll(".leaf-list-node");Array.prototype.slice.call(e).forEach((function(n){s(n,"active")})),p(n.currentTarget,"active")},e.onSelect=function(n){var t=n.node,r=n.onSelect;e.highlightItem(n.event),r(t)},e.onKeyUp=function(n){e.setState({q:n.target.value})},e.renderBody=function(n){var t=n.name,o=n.onSelect,i=n.apis.filter((function(n){var t=e.state.q;return""===t||n.path.indexOf(t)>-1}));return r.createElement(b,null,r.createElement(C,null,t),r.createElement(E,{placeholder:"搜索接口",onKeyUp:e.onKeyUp}),r.createElement(S,null,i.map((function(n){return r.createElement(k,{key:n.slug,id:n.slug,onClick:function(t){return e.onSelect({node:n,event:t,onSelect:o})},className:"leaf-list-node"},r.createElement(I,{className:n.method},n.method),r.createElement(w,null,n.path))}))))},e}return u(e,n),e.prototype.render=function(){var n=this;return r.createElement(f.Consumer,null,(function(e){return n.renderBody(e)}))},e}(r.Component);function j(){var n=l(["\n  font-size: 12px;\n  margin-right: 8px;\n"]);return j=function(){return n},n}function O(){var n=l(["\n  font-size: 10px;\n  margin-right: 8px;\n"]);return O=function(){return n},n}function _(){var n=l([""]);return _=function(){return n},n}function T(){var n=l(["\n  font-size: 14px;\n"]);return T=function(){return n},n}function q(){var n=l(["\n  font-size: 9px;\n  color: #ccc;\n  font-weight: light;\n"]);return q=function(){return n},n}function N(){var n=l(["\n  cursor: pointer;\n  &:hover {\n    color: #1abc9c;\n  }\n  &.active {\n    color: #1abc9c;\n    border-right: 2px solid #000;\n  }\n"]);return N=function(){return n},n}function P(){var n=l(["\n  padding: 4px 0 4px 15px;\n"]);return P=function(){return n},n}var M=o.li(P()),z=o.div(N()),B=o.span(q()),U=o.span(T()),D=o.ul(_()),R=o(e.Icon)(O()),K=o(e.Icon)(j()),L=function(n){function e(e){var t;return(t=n.call(this,e)||this).highlightItem=function(n,e){var t=document.querySelectorAll(".leaf-tree-node"),r=Array.prototype.slice.call(t);"file"===n.type&&(r.forEach((function(n){s(n,"active")})),p(e.currentTarget,"active"))},t.toggle=function(n,e){t.props.onSelect(n),t.setState(n.isRoot?{visible:t.state.visible}:{visible:!t.state.visible}),t.highlightItem(n,e)},t.state={visible:!1},t}return u(e,n),e.prototype.render=function(){var n,t=this,o=this.props,a=o.node,c=o.onSelect,u=void 0===c?{}:c,l=a.slug,f=a.type,p=a.title,s=a.method,d=void 0===s?"":s,m="file"===f?d+": "+a.url:"",v={display:this.state.visible||a.isRoot?"block":"none"};return null!=a.children&&(n=a.children.map((function(n){return r.createElement(e,{key:n.key,onSelect:u,node:n})}))),r.createElement(M,{title:m},r.createElement(i.ContextMenuTrigger,{id:"leaf-api-menu",collect:function(){return function(n){return{node:n}}(a)}},r.createElement(z,{id:l,className:"leaf-tree-node",onClick:function(n){return t.toggle(a,n)}},function(n,e){return"file"===n?null:r.createElement(R,e?{type:"down"}:{type:"right"})}(f,this.state.visible),function(n){return r.createElement(K,"file"===n?{type:"file-text"}:{type:"folder"})}(f),r.createElement(U,null,p),d&&r.createElement(B,null,".",d.toLowerCase()))),r.createElement(D,{style:v},n))},e}(r.Component);function J(n,e){if(!n||0===n.length)return{};var t=function(n){var e=[];return a.forEach(n,(function(n){var t,r=n.urlArr.length,o=n.urlArr;a.forEach(o,(function(i,c){t=0===c?{id:"/"+i+"/",isRoot:!0,key:"/"+i+"/",name:i,title:i,type:"directory"}:c<r-1?{title:i,name:o[c],id:"/"+o.slice(0,c+1).join("/")+"/",key:"/"+o.slice(0,c+1).join("/")+"/",parentId:"/"+o.slice(0,c).join("/")+"/",type:"directory"}:{title:i,name:a.last(o)+"."+n.type+".md",id:"/"+o.slice(0,c+1).join("/")+n.method+"/",key:"/"+o.slice(0,c+1).join("/")+n.method+"/",_id:n._id,parentId:"/"+n.urlArr.slice(0,c).join("/")+"/",type:"file",path:n.path,url:n.url,apiId:n._id,method:n.method,slug:n.slug},e.push(t)}))})),e}(n=function(n,e){var t=e?e+"'s API":"__apis__";return a.map(n,(function(n){var e=n.path.split("/");return e[0]=t,c({},n,{urlArr:e})}))}(n,e));t=function(n){var e=n.map((function(n){return JSON.stringify(n)}));return a.uniq(e).map((function(n){return JSON.parse(n)}))}(t);var r,o,i=a.filter(t,(function(n){return"directory"===n.type})),u=a.filter(t,(function(n){return"file"===n.type}));return function(n){var e={},t=null;return n&&n.length?(n.forEach((function(r){if((n.filter((function(n){return r.id===n.parentId})).length>0||void 0===r.parentId)&&(r.children=[]),e[r.id]=r,void 0===r.parentId)t=r;else{var o=e[r.parentId];o.children&&o.children.push(r)}})),t):[]}(i.concat((o=(r=u).slice(1).sort((function(n,e){return n.name.charCodeAt(0)>e.name.charCodeAt(0)?1:n.name.charCodeAt(0)<e.name.charCodeAt(0)?-1:0})),[r[0]].concat(o))))}function F(){var n=l(["\n  .leaf-api-menu {\n    cursor: pointer;\n    background: #fff;\n    border-radius: 4px;\n    box-shadow: 0 1px 6px rgba(0, 0, 0, 0.2);\n    .react-contextmenu-item {\n      padding: 10px 20px;\n    }\n  }\n"]);return F=function(){return n},n}var G=o.div(F()),H=function(n){function e(){var e;return(e=n.apply(this,arguments)||this).create=function(n){var e=n.context;e.onCreate&&e.onCreate(n.data.node)},e.delete=function(n){var e=n.context;e.onDelete&&e.onDelete(n.data.node)},e.renderBody=function(n){var t=n.onSelect,o=J(n.apis,n.name)||{};return r.createElement(G,null,r.createElement(i.ContextMenu,{className:"leaf-api-menu",id:"leaf-api-menu"},r.createElement(i.MenuItem,{data:{action:"create"},onClick:function(t){return e.create({data:t,context:n})}},"新建接口"),r.createElement(i.MenuItem,{data:{action:"delete"},onClick:function(t){return e.delete({data:t,context:n})}},"删除")),r.createElement("ul",null,r.createElement(L,{onSelect:t,node:o})))},e}return u(e,n),e.prototype.render=function(){var n=this;return r.createElement(f.Consumer,null,(function(e){return n.renderBody(e)}))},e}(r.Component);function Q(){var n=l(["\n  .ant-tabs-bar {\n    margin-bottom: 2px !important;\n  }\n  .ant-tabs-nav .ant-tabs-tab {\n    padding: 12px 10px;\n  }\n"]);return Q=function(){return n},n}var V=e.Tabs.TabPane,W=o.div(Q());exports.default=function(){var n=function(n){function t(){return n.apply(this,arguments)||this}return u(t,n),t.prototype.render=function(){var n=this.props,t=n.tabBarExtraContent;return n.name?r.createElement(f.Provider,{value:c({},this.props)},r.createElement(W,null,r.createElement(e.Tabs,{tabBarExtraContent:t},r.createElement(V,{tab:"树形",key:"1"},r.createElement(H,null)),r.createElement(V,{tab:"列表",key:"2"},r.createElement(A,null))))):null},t}(t.Component);return n.defaultProps={apis:[],name:"demo1",onCreate:null,onDelete:null,onSelect:null,onUpdate:null,tabBarExtraContent:null},n}();
//# sourceMappingURL=leaf-menu.cjs.production.min.js.map
